#include <stdio.h>
#include <stdlib.h>

/*
   :; gcc sudoku.c -o sudoku ; ./sudoku
   8 0 0 0 0 0 0 0 0
   0 0 3 6 0 0 0 0 0
   0 7 0 0 9 0 2 0 0
   0 5 0 0 0 7 0 0 0
   0 0 0 0 4 5 7 0 0
   0 0 0 1 0 0 0 3 0
   0 0 1 0 0 0 0 6 8
   0 0 8 5 0 0 0 1 0
   0 9 0 0 0 0 4 0 0

   8 1 2 7 5 3 6 4 9
   9 4 3 6 8 2 1 7 5
   6 7 5 4 9 1 2 8 3
   1 5 4 2 3 7 8 9 6
   3 6 9 8 4 5 7 2 1
   2 8 7 1 6 9 5 3 4
   5 2 1 9 7 4 3 6 8
   4 3 8 5 2 6 9 1 7
   7 9 6 3 1 8 4 5 2
*/

/* https://www.magicwordsquare.us/2012/06/ */

int a[9][9]=
{
#if 0
    { 4,0,9,0,0,0,7,0,8,},
    { 0,5,6,2,0,3,9,1,0,},
    { 1,0,0,0,0,0,0,0,5,},
    { 0,0,0,9,0,1,0,0,0,},
    { 0,1,0,0,3,0,0,2,0,},
    { 0,0,0,6,0,8,0,0,0,},
    { 3,0,0,0,0,0,0,0,9,},
    { 0,9,1,8,0,5,6,7,0,},
    { 6,0,8,0,0,0,5,0,2,},

      0,6,0,0,8,0,0,2,0,
      2,0,0,6,0,9,0,0,0,
      8,7,0,0,5,0,0,0,0,
      0,5,3,0,0,1,0,0,2,
      0,1,0,0,0,0,0,6,0,
      4,0,0,9,0,0,7,3,0,
      0,0,0,0,3,0,0,5,8,
      0,0,0,1,0,2,0,0,3,
      0,4,0,0,7,0,0,1,0,


      0,0,0,3,0,0,9,2,0,
      0,0,0,0,0,1,0,6,0,
      0,0,6,0,0,8,0,0,7,
      0,0,8,5,7,0,2,0,0,
      0,9,0,0,0,0,0,1,0,
      0,0,2,0,1,4,3,0,0,
      6,0,0,9,0,0,4,0,0,
      0,3,0,1,0,0,0,0,0,
      0,8,4,0,0,3,0,0,0,
#endif

/* http://www.telegraph.co.uk/news/science/science-news/9359579/Worlds-hardest-sudoku-can-you-crack-it.html */
   8,0,0,0,0,0,0,0,0,
   0,0,3,6,0,0,0,0,0,
   0,7,0,0,9,0,2,0,0,
   0,5,0,0,0,7,0,0,0,
   0,0,0,0,4,5,7,0,0,
   0,0,0,1,0,0,0,3,0,
   0,0,1,0,0,0,0,6,8,
   0,0,8,5,0,0,0,1,0,
   0,9,0,0,0,0,4,0,0,


};

void dump()
{
    int y;

    for(y=0;y<9;++y)
    {
        int x;

        for(x=0;x<9;++x)
        {
            printf("%d ",a[y][x]);
        }
        printf("\n");
    }
}

int next(int *x,int *y)
{
    if(++(*x)<9)
    {
        return 1;
    }

    *x=0;

    if(++(*y)<9)
    {
        return 1;
    }

    return 0;
}

void r(int x,int y)
{
    int s[10]={0,};
    int i;

    for(;;)
    {
        if(!a[y][x])
        {
            break;
        }

        if(!next(&x,&y))
        {
            dump();
            exit(0);
        }
    }

    for(i=0;i<9;++i)
    {
        s[a[y][i]]=1;
    }

    for(i=0;i<9;++i)
    {
        s[a[i][x]]=1;
    }

    {
        int xc=3*(x/3);
        int yc=3*(y/3);

        int yi;

        for(yi=0;yi<3;++yi)
        {
            int xi;

            for(xi=0;xi<3;++xi)
            {
                s[a[yc+yi][xc+xi]]=1;
            }
        }
    }
    
    for(i=1;i<=9;++i)
    {
        if(!s[i])
        {
            a[y][x]=i;
            r(x,y);
            a[y][x]=0;
        }
    }
}

int main()
{
    dump();

    printf("\n");

    r(0,0);

    return 0;
}
